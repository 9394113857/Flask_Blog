{% extends "layout.html" %}
{% block content %}
<article class="media content-section">
  <img class="rounded-circle article-img"
       src="{{ url_for('static', filename='profile_pics/' + post.author.image_file) }}">
  <div class="media-body">
    <div class="article-metadata">
      <a class="mr-2"
         href="{{ url_for('user_posts', username=post.author.username) }}">
        {{ post.author.username }}
      </a>
      <small class="text-muted">
        {{ post.date_posted.strftime('%Y-%m-%d') }}
      </small>
    </div>

    <h2 class="article-title">{{ post.title }}</h2>
    <p class="article-content">{{ post.content }}</p>

    <!-- LIKE BUTTON -->
    {% if current_user.is_authenticated %}
      <form action="{{ url_for('like_post', post_id=post.id) }}"
            method="POST" style="display:inline;">
        <button type="submit" class="btn btn-sm btn-outline-primary">
          üëç Like ({{ likes }})
        </button>
      </form>
    {% else %}
      <p><small>Login to like this post</small></p>
    {% endif %}
  </div>
</article>

<hr>

<!-- COMMENTS -->
<h4>Comments</h4>

{% if current_user.is_authenticated %}
  <form method="POST"
        action="{{ url_for('add_comment', post_id=post.id) }}">
    <div class="form-group">
      <textarea name="content"
                class="form-control"
                placeholder="Write a comment..."
                required></textarea>
    </div>
    <button type="submit" class="btn btn-primary btn-sm">
      Add Comment
    </button>
  </form>
{% else %}
  <p><small>Login to comment</small></p>
{% endif %}

<br>

{% for comment in comments %}
  <div class="content-section">
    <strong>{{ comment.user.username }}</strong>
    <small class="text-muted">
      {{ comment.timestamp.strftime('%Y-%m-%d %H:%M') }}
    </small>
    <p>{{ comment.content }}</p>
  </div>
{% endfor %}
{% endblock %}
